
<!DOCTYPE html>
<html lang="zh-Hans" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vue2+Koa2+MySQL全栈开发小案例todolist - 闫浩奇 の Blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="今夕何夕，遇此良人,生成项目创建项目。全局安装node和npm就不再赘述。全局安装vue脚手架npm i vue-cli -g。在想要生成项目的文件夹下执行vue init webpack todolisit,通过vu,"> 
    <meta name="author" content="闫浩奇"> 
    <link rel="alternative" href="atom.xml" title="闫浩奇 の Blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
</head>

<body class="loading">
    <span id="config-title" style="display:none">闫浩奇 の Blog</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="http://yoursite.com"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">Vue2+Koa2+MySQL全栈开发小案例todolist</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">Vue2+Koa2+MySQL全栈开发小案例todolist</h1>
        <div class="stuff">
            <span>九月 05, 2017</span>
            

        </div>
        <div class="content markdown">
            <h3 id="生成项目"><a href="#生成项目" class="headerlink" title="生成项目"></a>生成项目</h3><p>创建项目。全局安装node和npm就不再赘述。全局安装vue脚手架<code>npm i vue-cli -g</code>。在想要生成项目的文件夹下执行<code>vue init webpack todolisit</code>,通过vue-cli创建一个基于webpack的vue项目,名为todolist。<br>安装依赖。在package.json中添加koa相关依赖<code>koa koa-router koa-bodyparser -koa-json koa-logger</code>。在项目文件夹下<code>npm i</code>安装。<br>补充项目结构。在项目根目录下新建server文件夹及其子文件夹如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">├── server</div><div class="line">   │   ├── config</div><div class="line">   │   ├── controllers</div><div class="line">   │   ├── models</div><div class="line">   │   ├── routes</div><div class="line">   │   └── schema</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><p>在项目目录下添加<code>app.js</code>作为koa服务器的启动文件，在app.js中引入koa启动服务并且监听在3000端口，命令行<code>node app.js</code>检测服务是否正常启动。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">const koa = require(&apos;koa&apos;);</div><div class="line">const app = new koa();</div><div class="line"></div><div class="line">app.use(async (ctx,next) =&gt; &#123;</div><div class="line">  console.log(ctx.request.method,ctx.request.url);</div><div class="line">&#125;);</div><div class="line">app.on(&apos;error&apos;,function(err,ctx)&#123;</div><div class="line">  console.log(&apos;server err======&apos;,err);</div><div class="line">&#125;);</div><div class="line">app.listen(3000,() =&gt; &#123;</div><div class="line">  console.log(&apos;server is starting===========&apos;);</div><div class="line">&#125;);</div><div class="line">module.exports = app;</div></pre></td></tr></table></figure></p>
<h3 id="前端页面构建"><a href="#前端页面构建" class="headerlink" title="前端页面构建"></a>前端页面构建</h3><p>ui框架采用<code>element-ui</code>，css预处理语言采用<code>stylus</code>,去package.json中配置<code>element-ui stylus stylus-loader</code>执行<code>npm i</code>安装。更改src目录下vue的入口js文件main.js如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">import Vue from &apos;vue&apos;</div><div class="line">import App from &apos;./App.vue&apos;</div><div class="line">import ElementUI from &apos;element-ui&apos;</div><div class="line">import &apos;element-ui/lib/theme-default/index.css&apos;</div><div class="line">// 全局使用</div><div class="line">Vue.use(ElementUI)</div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#app&apos;,</div><div class="line">  template: &apos;&lt;App/&gt;&apos;,</div><div class="line">  components: &#123; App &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>在入口html文件即项目目录下index.html中添加<code>&lt;meta name=&quot;viewport&quot; content=&quot;width=divice-width,user-scalable=no,initial-sale=1.0,maximum-scale=1.0,mininum-scale=1.0&quot;&gt;</code>实现适配。<br>命令行<code>npm run dev</code>，浏览器在8080端口会响应初始vue页面。这个页面是通过vue-cli内置的的server.js的服务器响应的，而不是我们刚刚自己写的koa服务，我们的服务是监听在3000端口。<br><img src="/2017/09/05/Vue2+Koa2+MySQL全栈开发小案例todolist/todo1.png" alt=""></p>
<h3 id="登录界面"><a href="#登录界面" class="headerlink" title="登录界面"></a>登录界面</h3><p>在src下的components文件夹下新建<code>Login.vue</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;el-row class=&quot;content&quot;&gt;</div><div class="line">    &lt;!--xs:&lt;768px sm:&gt;=768px md:&gt;=992px lg:&gt;=1200px type:number/object--&gt;</div><div class="line">    &lt;el-col :xs=&quot;24&quot; :sm=&quot;&#123;span:6,offset:9&#125;&quot;&gt;</div><div class="line">      &lt;span class=&quot;title&quot;&gt;</div><div class="line">        ToDoList-yanhaoqi</div><div class="line">      &lt;/span&gt;</div><div class="line">      &lt;el-row&gt;</div><div class="line">        &lt;el-input v-model=&quot;account&quot; pleaseholder=&quot;请输入账号&quot; type=&quot;text&quot;&gt;&lt;/el-input&gt;</div><div class="line">        &lt;el-input v-model=&quot;password&quot; placeholder=&quot;请输入密码&quot; type=&quot;password&quot;&gt;</div><div class="line">        &lt;/el-input&gt;</div><div class="line">      &lt;/el-row&gt;</div><div class="line">      &lt;el-button type=&quot;primary&quot;&gt;登录&lt;/el-button&gt;</div><div class="line">    &lt;/el-col&gt;</div><div class="line">  &lt;/el-row&gt;</div><div class="line">&lt;/template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">export default&#123;</div><div class="line">    data()&#123;</div><div class="line">        return &#123;</div><div class="line">            account:&apos;&apos;,</div><div class="line">            password:&apos;&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;!--scoped属性保证样式只对该组件生效--&gt;</div><div class="line">&lt;style lang=&quot;stylus&quot; scoped&gt;</div><div class="line">  .el-row.content</div><div class="line">    padding 16px</div><div class="line">    text-align center</div><div class="line">    margin-top 200px</div><div class="line">  .title</div><div class="line">    font-size 28px</div><div class="line">  .el-input</div><div class="line">    margin 12px 0</div><div class="line">  .el-button</div><div class="line">    width 100%</div><div class="line">    margin-top 12px</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>注意：<code>&lt;template&gt;&lt;/template&gt;</code>标签内只能有1个子标签。一般我们写完一个<code>&lt;template&gt;&lt;/template&gt;</code>后紧接着会写一个<code>&lt;div&gt;&lt;/div&gt;</code>或者<code>&lt;section&gt;&lt;/section&gt;</code>或其他的块元素作为容器，然后再在容器内写页面结构。<br>写好了<code>Login.vue</code>组件后，在<code>App.vue</code>中，1-引入组件、2-注册组件、3-使用组件。把组件注册进了Vue对象。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div id=&quot;app&quot;&gt;</div><div class="line">    &lt;!--使用组件--&gt;</div><div class="line">    &lt;Login&gt;&lt;/Login&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">//  引入组件</div><div class="line">import Login from &apos;./components/Login&apos;</div><div class="line">export default &#123;</div><div class="line">  name: &apos;app&apos;,</div><div class="line">//  注册组件</div><div class="line">  components:&#123;</div><div class="line">      Login</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div><div class="line"></div><div class="line">&lt;style&gt;</div><div class="line"></div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>给<code>Login.vue</code>中的登录按钮添加点击事件，使点击按钮时候导航到其他url，用<code>this.$router(&#39;路由&#39;)</code>。改两行代码就可以，代码不贴了，完整代码请看github链接。<br>另外，为了开发方便，我关掉了烦人的eslint。方法是<code>build/webpack.bace.conf.js</code>文件中注释掉如下部分：<br><img src="/2017/09/05/Vue2+Koa2+MySQL全栈开发小案例todolist/todo2.png" alt=""><br>现在登录界面基本完成。<br><img src="/2017/09/05/Vue2+Koa2+MySQL全栈开发小案例todolist/todo3.png" alt=""></p>
<h3 id="ToDoList页面-初步"><a href="#ToDoList页面-初步" class="headerlink" title="ToDoList页面-初步"></a>ToDoList页面-初步</h3><p>先把基础的页面结构写一下，边写边调试。写了<code>&lt;span&gt;&lt;/span&gt; &lt;el-input&gt;&lt;el-input/&gt; &lt;el-tabs&gt;&lt;el-tabs&gt;</code>基本元素。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;el-row class=&quot;content&quot;&gt;</div><div class="line">    &lt;el-col :xs=&quot;&#123;span:20,offset:2&#125;&quot; :sm=&quot;&#123;span:8,offset:8&#125;&quot;&gt;</div><div class="line">      &lt;span&gt;</div><div class="line">        欢迎 &#123;&#123;name&#125;&#125; ! 您的待办事项：</div><div class="line">      &lt;/span&gt;</div><div class="line">      &lt;!--.native修饰符 在元素上监听一个原生事件--&gt;</div><div class="line">      &lt;el-input placeholder=&quot;请输入待办事项&quot; v-model=&quot;todos&quot; @keyup.enter.native=&quot;addTodos&quot;&gt;&lt;/el-input&gt;</div><div class="line">      &lt;el-tabs v-model=&quot;activeName&quot;&gt;</div><div class="line">        &lt;el-tab-pane label=&quot;待办事项&quot; name=&quot;first&quot;&gt;</div><div class="line">          &lt;el-col :xs=&quot;24&quot;&gt;&lt;/el-col&gt;</div><div class="line">        &lt;/el-tab-pane&gt;</div><div class="line">        &lt;el-tab-pane label=&quot;已完成事项&quot; name=&quot;second&quot;&gt;&lt;/el-tab-pane&gt;</div><div class="line">      &lt;/el-tabs&gt;</div><div class="line">    &lt;/el-col&gt;</div><div class="line">  &lt;/el-row&gt;</div><div class="line">&lt;/template&gt;</div><div class="line">&lt;script&gt;</div><div class="line">  export default&#123;</div><div class="line">      data()&#123;</div><div class="line">          return &#123;</div><div class="line">            name:&apos;闫浩奇&apos;,</div><div class="line">            todos:&apos;&apos;,</div><div class="line">            activeName:&apos;&apos;</div><div class="line">          &#125;</div><div class="line">      &#125;,</div><div class="line">      methods:&#123;</div><div class="line">        addTodos()&#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">  &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;style lang=&quot;stylus&quot; scope&gt;</div><div class="line"></div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>然后需要到浏览器看一下现在页面是什么样子，再继续写后面的。那么问题来了，我们还是和Lonin.vue一样，到根组件App.vue中引入、注册、使用TodoList.vue组件吗？No.在功能上看，这两个组件是两个不同的页面，我们不能都放在根组件App.vue中。这时候，我们需要引入前端路由vue-router，通过路由的跳转，在浏览器中展示不同的页面。</p>
<h3 id="引入路由"><a href="#引入路由" class="headerlink" title="引入路由"></a>引入路由</h3><p>在入口js<code>main.js</code>中，引入路由，全局使用路由。引入需要路由到的组件，实例化路由，配置不同路由对应的路由到的组件。实例化Vue，注册路由。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">// The Vue build version to load with the `import` command</div><div class="line">// (runtime-only or standalone) has been set in webpack.base.conf with an alias.</div><div class="line">import Vue from &apos;vue&apos;</div><div class="line">import App from &apos;./App.vue&apos;</div><div class="line">import ElementUI from &apos;element-ui&apos;</div><div class="line">import &apos;element-ui/lib/theme-default/index.css&apos;</div><div class="line">import VueRouter from &apos;vue-router&apos;</div><div class="line">// 全局使用</div><div class="line">Vue.use(ElementUI)</div><div class="line">Vue.use(VueRouter)</div><div class="line"></div><div class="line">import Login from &apos;./components/Login.vue&apos;</div><div class="line">import TodoList from &apos;./components/TodoList.vue&apos;</div><div class="line">const router = new VueRouter(&#123;</div><div class="line">  //开启h5的history模式，让地址栏的url没有#，和正常的url一样</div><div class="line">  mode:&apos;history&apos;,</div><div class="line">  bace:__dirname,</div><div class="line">  routes:[</div><div class="line">    &#123;</div><div class="line">      path:&apos;/&apos;,</div><div class="line">      component:Login</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      path:&apos;/todo&apos;,</div><div class="line">      component:TodoList</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      path:&apos;*&apos;,</div><div class="line">      //输入其他路由跳转到根目录</div><div class="line">      redirect:&apos;/&apos;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;);</div><div class="line">//3种写法</div><div class="line">//传一个路由属性给Vue实例</div><div class="line">// new Vue(&#123;</div><div class="line">//   router:router,</div><div class="line">//   el: &apos;#app&apos;,</div><div class="line">//   template: &apos;&lt;App/&gt;&apos;,</div><div class="line">//   components: &#123; App &#125;</div><div class="line">// &#125;)</div><div class="line"></div><div class="line">// new Vue(&#123;</div><div class="line">//   router:router,</div><div class="line">//   //参数是个函数，调动该函数并且传入App组件作为实参</div><div class="line">//   render:h =&gt; h(App)</div><div class="line">//   //挂载到#app元素上</div><div class="line">// &#125;).$mount(&apos;#app&apos;);</div><div class="line"></div><div class="line">//运行时构建&lt;router-view&gt;&lt;router-view/&gt;</div><div class="line">new Vue(&#123;</div><div class="line">  el:&apos;#app&apos;,</div><div class="line">  router:router,</div><div class="line">  render:h =&gt; h(&apos;router-view&apos;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>在这里，实例化Vue的时候有两种方法，个人目前还是比较喜欢第3种，因为是运行时构建<code>&lt;router-view&gt;&lt;router-view/&gt;</code>,这样不必在根组件中使用<code>路由视图元素&lt;vue-router&gt;&lt;vue-router/&gt;</code>,如果是前两种的话，则必须要用。<br>然后再在根组件App.vue中，去掉之前Login和TodoList组件引入、注册、使用的代码，因为这两个组件已经在<code>main.js</code>路由引入的过程中引入和注册了，在这里使用<code>路由视图渲染元素</code>即可。<br>这样就可以通过/todo路由访问到TodoList.vue页面了，方便在继续开发TodoList.vue页面时候边开发边调试。</p>
<h3 id="TodoList页面-完成"><a href="#TodoList页面-完成" class="headerlink" title="TodoList页面-完成"></a>TodoList页面-完成</h3><p>TodoList.vue页面的开发调试过程不再赘述，直接上代码，重要信息我已备注。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;el-row class=&quot;content&quot;&gt;</div><div class="line">    &lt;el-col :xs=&quot;&#123;span:20,offset:2&#125;&quot; :sm=&quot;&#123;span:8,offset:8&#125;&quot;&gt;</div><div class="line">      &lt;span&gt;</div><div class="line">        欢迎 &#123;&#123;name&#125;&#125; ! &amp;nbspTips:今日事今日毕</div><div class="line">      &lt;/span&gt;</div><div class="line">      &lt;!--.native修饰符 在元素上监听一个原生事件 .trim 去掉输入框内容的前后空格--&gt;</div><div class="line">      &lt;el-input placeholder=&quot;请输入待办事项&quot; v-model.trim=&quot;todos&quot; @keyup.enter.native=&quot;addTodos&quot;&gt;&lt;/el-input&gt;</div><div class="line">      &lt;el-tabs v-model=&quot;activeName&quot; type=&quot;border-card&quot;&gt;</div><div class="line"></div><div class="line">        &lt;el-tab-pane label=&quot;待办事项&quot; name=&quot;first&quot;&gt;</div><div class="line">          &lt;el-col :xs=&quot;24&quot;&gt;</div><div class="line">            &lt;!--全部完成-不显示，否则-显示--&gt;</div><div class="line">            &lt;template v-if=&quot;!Done&quot;&gt;</div><div class="line">              &lt;template v-for=&quot;(item, index) in list&quot;&gt;</div><div class="line">                &lt;!--显示status为false的--&gt;</div><div class="line">                &lt;div class=&quot;todo-list&quot; v-if=&quot;item.status == false&quot;&gt;</div><div class="line">                  &lt;span class=&quot;item&quot;&gt;</div><div class="line">                    &#123;&#123;index + 1&#125;&#125;. &#123;&#123;item.content&#125;&#125;</div><div class="line">                  &lt;/span&gt;</div><div class="line">                  &lt;span class=&quot;pull-right&quot;&gt;</div><div class="line">                    &lt;el-button size=&quot;small&quot; type=&quot;primary&quot; @click=&quot;finished(index)&quot;&gt;完成&lt;/el-button&gt;</div><div class="line">                    &lt;el-button size=&quot;small&quot; type=&quot;primary&quot; @click=&quot;remove(index)&quot;&gt;删除&lt;/el-button&gt;</div><div class="line">                  &lt;/span&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">              &lt;/template&gt;</div><div class="line">            &lt;/template&gt;</div><div class="line">            &lt;div v-else-if=&quot;Done&quot;&gt;</div><div class="line">              暂无待办事项，Greet!</div><div class="line">            &lt;/div&gt;</div><div class="line">          &lt;/el-col&gt;</div><div class="line">        &lt;/el-tab-pane&gt;</div><div class="line"></div><div class="line">        &lt;el-tab-pane label=&quot;已完成事项&quot; name=&quot;second&quot;&gt;</div><div class="line">          &lt;template v-if=&quot;this.count &gt; 0&quot;&gt;</div><div class="line">            &lt;template v-for=&quot;(item, index) in list&quot;&gt;</div><div class="line">              &lt;div class=&quot;todo-list&quot; v-if=&quot;item.status == true&quot;&gt;</div><div class="line">                &lt;span class=&quot;item finished&quot;&gt;&#123;&#123;index + 1&#125;&#125;. &#123;&#123;item.content&#125;&#125;&lt;/span&gt;</div><div class="line">                &lt;span class=&quot;pull-right&quot;&gt;</div><div class="line">                  &lt;el-button size=&quot;small&quot; type=&quot;primary&quot; @click=&quot;restore(index)&quot;&gt;还原&lt;/el-button&gt;</div><div class="line">                &lt;/span&gt;</div><div class="line">              &lt;/div&gt;</div><div class="line">            &lt;/template&gt;</div><div class="line">          &lt;/template&gt;</div><div class="line">          &lt;div v-else&gt;</div><div class="line">            暂无已完成事项，加油哦!</div><div class="line">          &lt;/div&gt;</div><div class="line">        &lt;/el-tab-pane&gt;</div><div class="line">      &lt;/el-tabs&gt;</div><div class="line">    &lt;/el-col&gt;</div><div class="line">  &lt;/el-row&gt;</div><div class="line">&lt;/template&gt;</div><div class="line">&lt;script&gt;</div><div class="line">  export default&#123;</div><div class="line">      data()&#123;</div><div class="line">          return &#123;</div><div class="line">            name:&apos;闫浩奇&apos;,</div><div class="line">            todos:&apos;&apos;,</div><div class="line">            activeName:&apos;first&apos;,</div><div class="line">            list:[],</div><div class="line">            count:0 //已完成的数量</div><div class="line">          &#125;</div><div class="line">      &#125;,</div><div class="line">      methods:&#123;</div><div class="line">        addTodos()&#123;</div><div class="line">          if(this.todos != &apos;&apos;)&#123;</div><div class="line">            let todoObj = &#123;</div><div class="line">                status:false,</div><div class="line">                content:this.todos</div><div class="line">            &#125;;</div><div class="line">            this.list.push(todoObj)</div><div class="line">            this.todos = &apos;&apos;</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        finished(index)&#123;</div><div class="line">//          this.list[index].status == true</div><div class="line">//          Vue只能监测到data对象的直接属性的变化，对于直接属性嵌套的第二层对象的属性的变化，要用$set来监测</div><div class="line">          this.$set(this.list[index],&apos;status&apos;,true)</div><div class="line">          this.$message(&#123;</div><div class="line">            type:&apos;success&apos;,</div><div class="line">            message:&apos;任务完成&apos;</div><div class="line">          &#125;)</div><div class="line">        &#125;,</div><div class="line">        remove(index,flag)&#123;</div><div class="line">          let confirmTxt = &apos;&apos;;</div><div class="line">          if(flag == 0)&#123;</div><div class="line">              confirmTxt = &apos;待办&apos;</div><div class="line">          &#125;else if(flag == 1)&#123;</div><div class="line">            confirmTxt = &apos;已完成&apos;</div><div class="line">          &#125;</div><div class="line">//          模板字符串</div><div class="line">          this.$confirm(`确认删除$&#123;confirmTxt&#125;事项 $&#123;this.list[index].content&#125; 吗？`,&apos;提示&apos;,&#123;</div><div class="line">              confirmButtonText:&apos;确定&apos;,</div><div class="line">              cancelButtonText:&quot;取消&quot;,</div><div class="line">              type:&apos;warning&apos;</div><div class="line">          &#125;).then( () =&gt; &#123;</div><div class="line">              this.list.splice(index,1);</div><div class="line">              this.$message(&#123;</div><div class="line">                type:&apos;success&apos;,</div><div class="line">                message:&apos;删除成功&apos;</div><div class="line">              &#125;)</div><div class="line">          &#125; ).catch( () =&gt;&#123;</div><div class="line">            this.$message(&#123;</div><div class="line">              type:&apos;info&apos;,</div><div class="line">              message:&apos;取消删除&apos;</div><div class="line">            &#125;)</div><div class="line">          &#125; );</div><div class="line">        &#125;,</div><div class="line">        restore(index)&#123;</div><div class="line">          this.$confirm(`确认还原已完成事项 $&#123;this.list[index].content&#125; 吗？`,&apos;提示&apos;,&#123;</div><div class="line">              confirmButtonText:&apos;确定&apos;,</div><div class="line">              cancelButtonText:&apos;取消&apos;,</div><div class="line">              type:&apos;warning&apos;</div><div class="line">          &#125;).then( () =&gt; &#123;</div><div class="line">            this.$set(this.list[index],&apos;status&apos;,false)</div><div class="line">            this.$message(&#123;</div><div class="line">              type:&apos;success&apos;,</div><div class="line">              message:&apos;还原成功&apos;</div><div class="line">            &#125;)</div><div class="line">          &#125;).catch( () =&gt; &#123;</div><div class="line">              this.$message(&#123;</div><div class="line">                type:&apos;info&apos;,</div><div class="line">                message:&apos;取消还原&apos;</div><div class="line">              &#125;)</div><div class="line">          &#125;)</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      computed:&#123;</div><div class="line">          Done()&#123;</div><div class="line">              let count = 0;</div><div class="line">              let length = this.list.length; //总数量</div><div class="line">//              数组的for in， i为数组的索引  对象的for in, i为对象的属性名</div><div class="line">              for(let i in this.list)&#123;</div><div class="line">                  this.list[i].status == true ? count++ : &apos;&apos;;</div><div class="line">              &#125;</div><div class="line">//              把计算好的已完成的数量赋值给count</div><div class="line">              this.count = count</div><div class="line">              if(count == length || length == 0)&#123;</div><div class="line">//                  全部完成，没有待办事项 Done:true</div><div class="line">                  return true</div><div class="line">              &#125;else&#123;</div><div class="line">//                  没有完成 Done:false</div><div class="line">                  return false</div><div class="line">              &#125;</div><div class="line">          &#125;</div><div class="line">      &#125;</div><div class="line">  &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;style lang=&quot;stylus&quot; scope&gt;</div><div class="line">  .el-input</div><div class="line">    margin 20px auto</div><div class="line">  .todo-list</div><div class="line">    width 100%</div><div class="line">    margin-top 8px</div><div class="line">    padding-bottom 8px</div><div class="line">    border-bottom 1px solid #eee</div><div class="line">    overflow hidden</div><div class="line">    text-align left</div><div class="line">  .item</div><div class="line">    font-size 20px</div><div class="line">    &amp;.finished</div><div class="line">      text-decoration line-through</div><div class="line">      corlor #ddd</div><div class="line">  .pull-right</div><div class="line">    float right</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>说几个重要的细节。如果需要先用v-show判断是否显示，如果显示，然后用v-for遍历展示的场景，要用两个嵌套的<code>&lt;template v-if=&quot;isShow&quot;&gt; &lt;template v-for=&quot;(item,index) in list&quot;&gt;...&lt;template/&gt; &lt;template/&gt;</code>这样嵌套结构，因为当v-if和v-for出现在同一个标签时候，Vue总是先渲染v-for，所以我们把v-if放在外面的<template></template>就可以了。<br>Vue只能监测到data对象的直接属性的变化，对于直接属性嵌套的第二层对象的属性的变化，要用$set来监测，在data中某属性的值是数组、数组的元素是对象这样的数据结构中经常用到$set。</p>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p>第一次使用MySQL。安装MySQL请自行百度。安装完毕后在命令行<code>mysql --version</code>验证是否安装成功，修改默认密码等都问度娘就可以了。安装可视化工具Sequel Pro，官网<code>https://www.sequelpro.com/</code>。在<code>系统偏好设置</code>中启动MySQL，打开Sequel Pro.登录。<br><img src="/2017/09/05/Vue2+Koa2+MySQL全栈开发小案例todolist/sequel1.png" alt=""></p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title='0' data-url='http://link.hhtjim.com/163/5146554.mp3'></li>
                    
                        <li title='1' data-url='http://link.hhtjim.com/qq/001faIUs4M2zna.mp3'></li>
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
        data-ae='true'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>
